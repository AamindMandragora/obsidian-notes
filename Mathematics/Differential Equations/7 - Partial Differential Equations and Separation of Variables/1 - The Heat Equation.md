The heat equation or diffusion equation governs phenomena like the propagation of heat in a solid body or diffusion of a dye in a liquid. The partial differential equation in three spatial dimensions is: $$\frac{\partial u}{\partial t}=\sigma\left(\frac{\partial^2u}{\partial x^2}+\frac{\partial^2u}{\partial y^2}+\frac{\partial^2u}{\partial z^2}\right)$$where $\sigma$ is the thermal diffusivity and $u(x,y,z,t)$ is the heat or concentration at location $(x,y,z)$ at time $t$. The PDE in one spatial dimension is $$\frac{\partial u}{\partial t}=\sigma\frac{\partial^2u}{\partial x^2}$$and this one dimensional heat equation governs propagation of heat in one-dimensional media like a thin rod. If $u(x,t)$ is a local minimum, then the second derivative with respect to space (and the first derivative with respect to time) are both positive, and vice versa for local maxima.

We often have to specify an initial temperature distribution $u(x,0)$, as well as the heat (Dirichlet) or rate of change of heat (Neumann) at the boundaries at time $t$.
# The Heat Equation with Dirichlet Boundary Conditions

The heat equation with Dirichlet boundary conditions is $$\begin{align}\frac{\partial u}{\partial t}=\sigma\frac{\partial^2u}{\partial x^2} \\ u(x,0)=u_0(x) \\ u(0,t)=T_{\text{left}}\\u(L,t)=T_{\text{right}}\end{align}$$The first step in solving is to make the boundary conditions homogeneous. In other words, we must find the **equilibrium solution** which satisfies $$\begin{align}\frac{\partial^2u}{\partial x^2}=0 \\ u(0,t)=T_{\text{left}}\\u(L,t)=T_{\text{right}}\end{align}$$This is basically an ODE, so integrating up twice and plugging in boundary conditions gives us $$\mu_e(x)=T_\text{left}+\frac{T_\text{right}-T_\text{left}}{L}x$$If we define $v(x,t)=u(x,t)-\mu_e(x)$, then it's straightforward to show that $$\begin{align}\frac{\partial v}{\partial t}=\sigma\frac{\partial^2v}{\partial x^2} \\ v(x,0)=u_0(x)-\mu_e(x) \\ v(0,t)=0 \\ v(L,t)=0\end{align}$$
# Separation of Variables

We begin with the heat equation in terms of $v(x,t)$ shown above. Ignoring the initial condition, we'll look for a solution of the form $v(x,t)=T(t)X(x)$. Substituting into the heat equation gives $$\frac{dT}{dt}(t)X(x)=\sigma T(t)\frac{d^2X}{dx^2}(x)$$which can be rearranged to form $$\frac{T'(t)}{T(t)}=\sigma\frac{X''(x)}{X(x)}$$It's clear that both sides must be constant, so set $$X''(x)=-\lambda X(x)$$and including the boundary conditions that $X(0)=0,~ X(L)=0$ we now have an eigenvalue problem which can be solved by $$X(x)=B\sin\left(\frac{n\pi x}{L}\right)$$with eigenvalues $\lambda=\frac{n^2\pi^2}{L^2}$. Plugging back into the left hand side, we get $$T'(t)=-\sigma\lambda T(t)$$which can be easily solved to get an exponential function. Now that we've found a solution for each $n$, we can sum them all to find a more general solution. This process is called **superposition**.

Finally, we can substitute the initial condition back into the equation, then use the fact that the functions of sine for each $n$ are orthogonal, so we can do $$B_n=\frac{2}{L}\int_0^Lv_0(x)\sin\left(\frac{n\pi x}{L}\right)dx$$to find the coefficients.
# The Heat Equation With Neumann Boundary Conditions

The same basic technique used above will apply to many different kinds of boundary conditions. The next most important type of boundary condition is Neumann (zero flux boundary conditions). A homogeneous Neumann boundary condition means that there is zero flux of heat through the boundary (insulated) and a typical heat problem with Neumann boundary conditions will look like $$\begin{align}v_t=\sigma v_{xx} \\ v(x,0)=v_0(x) \\ v_x(0,t)=0\\ v_x(L,t)=0\end{align}$$We can solve this using separation of variables, which turns it into an eigenvalue problem just like before. The solution is $$v(x,t)=A_0+\sum A_n\cos\left(\frac{n\pi x}{L}\right)e^{-\sigma\lambda t}$$and we can solve for the coefficients the exact same way as before to get $$A_n=\frac{2}{L}\int_0^Lv_0(x)\cos\left(\frac{n\pi x}{L}\right)dx$$We also have to solve for $A_0=\int_0^Lv_0(x)dx$ as this is a Fourier cosine series problem.